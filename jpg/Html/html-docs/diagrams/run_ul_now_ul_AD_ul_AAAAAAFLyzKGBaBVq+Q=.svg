<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="960" height="1229"><defs></defs><g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 257 99 L 753 99 Q 763 99 763 109 L 763 277 Q 763 287 753 287 L 257 287 Q 247 287 247 277 L 247 109 Q 247 99 257 99 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 250 92 L 746 92 Q 756 92 756 102 L 756 270 Q 756 280 746 280 L 250 280 Q 240 280 240 270 L 240 102 Q 240 92 250 92 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 250 92 L 746 92 Q 756 92 756 102 L 756 270 Q 756 280 746 280 L 250 280 Q 240 280 240 270 L 240 102 Q 240 92 250 92 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="438" y="111.5">Variable Initialization</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 252 120 L 729 120 L 739 130 L 739 278 L 252 278 L 252 120"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 252 120 L 729 120 L 739 130 L 739 278 L 252 278 L 252 120 L 252 120" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 729 120 L 729 130 L 739 130 L 729 120" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="138">1)cr_type = CR_CPU; // Global var, init() assigns cr_type based on slurm.conf</text><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="151">cr_type</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="166">part_res_record *select_part_record; int select_node_cnt=0;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="181">node_res_record *select_node_record;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="196">node_use_record *select_node_usage;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="211">2)tmp_cr_type = cr_type ;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="226">  save_bitmap = bit_copy(bitmap); // safe from the change</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="241">3)top: orig_map = bit_copy(save_bitmap);</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="256">4)if(job_ptr -&gt;part_ptr -&gt;cr_type) </text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="271">        tmp_cr_type |= job_ptr-&gt;part_ptr-&gt;cr_type;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 257 311 L 753 311 Q 763 311 763 321 L 763 452 Q 763 462 753 462 L 257 462 Q 247 462 247 452 L 247 321 Q 247 311 257 311 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 250 304 L 746 304 Q 756 304 756 314 L 756 445 Q 756 455 746 455 L 250 455 Q 240 455 240 445 L 240 314 Q 240 304 250 304 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 250 304 L 746 304 Q 756 304 756 314 L 756 445 Q 756 455 746 455 L 250 455 Q 240 455 240 445 L 240 314 Q 240 304 250 304 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="403" y="323.5">Allocate resources for a Job now</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 252 328 L 729 328 L 739 338 L 739 454 L 252 454 L 252 328"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 252 328 L 729 328 L 739 338 L 739 454 L 252 454 L 252 328 L 252 328" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 729 328 L 729 338 L 739 338 L 729 328" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="346">1)rc=cr_job_test(job_ptr,bit_map,tmp_cr_type,job_node_req,</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="361">select_node_cnt,slect_part_record,select_node_usage,</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="376">exc_core_map,false,false);</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="391">2)If( rc = SLURM_SUCCESS ) </text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="406">     return SLURM_SUCCESS;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="421">   else </text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="436"> /*Not enough resource, So handle preemptee_candidate, preempt_by_qos,</text><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="257" y="449">preemptee_job_list*/</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 453 567 L 957 567 Q 967 567 967 577 L 967 649 Q 967 659 957 659 L 453 659 Q 443 659 443 649 L 443 577 Q 443 567 453 567 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 446 560 L 950 560 Q 960 560 960 570 L 960 642 Q 960 652 950 652 L 446 652 Q 436 652 436 642 L 436 570 Q 436 560 446 560 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 446 560 L 950 560 Q 960 560 960 570 L 960 642 Q 960 652 950 652 L 446 652 Q 436 652 436 642 L 436 570 Q 436 560 446 560 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="546.5" y="579.5">Not enough resources _ So handle preemptable jobs</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 448 588 L 939 588 L 949 598 L 949 651 L 448 651 L 448 588"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 448 588 L 939 588 L 949 598 L 949 651 L 448 651 L 448 588 L 448 588" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 939 588 L 939 598 L 949 598 L 939 588" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="453" y="606">1)if( rc!=SLURM_SUCCESS &amp; preemptee_candidates &amp; preempt_qos )</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="453" y="621">   mode = slurm_job_preempt_mode</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="453" y="636">               ((struct job_record*)list_next(list_iterator_create(preempt_candidate)))</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 495 72.5 C 495 67.2532944 499.2532944 63 504.5 63 C 509.7467056 63 514 67.2532944 514 72.5 C 514 77.7467056 509.7467056 82 504.5 82 C 499.2532944 82 495 77.7467056 495 72.5 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#000000" stroke="none" d="M 488 65.5 C 488 60.2532944 492.2532944 56 497.5 56 C 502.7467056 56 507 60.2532944 507 65.5 C 507 70.7467056 502.7467056 75 497.5 75 C 492.2532944 75 488 70.7467056 488 65.5 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 495 1259.5 C 495 1252.59644 500.59644 1247 507.5 1247 C 514.40356 1247 520 1252.59644 520 1259.5 C 520 1266.40356 514.40356 1272 507.5 1272 C 500.59644 1272 495 1266.40356 495 1259.5 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 488 1252.5 C 488 1245.59644 493.59644 1240 500.5 1240 C 507.40356 1240 513 1245.59644 513 1252.5 C 513 1259.40356 507.40356 1265 500.5 1265 C 493.59644 1265 488 1259.40356 488 1252.5 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#000000" stroke="none" d="M 493 1252.5 C 493 1248.357864 496.357864 1245 500.5 1245 C 504.642136 1245 508 1248.357864 508 1252.5 C 508 1256.642136 504.642136 1260 500.5 1260 C 496.357864 1260 493 1256.642136 493 1252.5 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 497.09090909090907 76 L 497.2148760330578 91" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 492.92151584726696 80.87246040170338 L 497.2148760330578 91 L 501.3402638582996 80.80288397186014" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 498 281 L 498 303" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 493.790482243984 292.83732514237585 L 498 303 L 502.209517756016 292.83732514237585" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 254 503 L 759 503 Q 762 503 762 506 L 762 505 Q 762 508 759 508 L 254 508 Q 251 508 251 505 L 251 506 Q 251 503 254 503 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#000000" stroke="none" d="M 247 496 L 752 496 Q 755 496 755 499 L 755 499 Q 755 502 752 502 L 247 502 Q 244 502 244 499 L 244 499 Q 244 496 247 496 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 498.6470588235294 456 L 498.97478991596637 495" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 494.68002316887686 484.8730567994042 L 498.97478991596637 495 L 503.09876143531716 484.80231109968616" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="507" y="477">check "rc"</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 233 567 L 428 567 Q 438 567 438 577 L 438 609 Q 438 619 428 619 L 233 619 Q 223 619 223 609 L 223 577 Q 223 567 233 567 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 226 560 L 421 560 Q 431 560 431 570 L 431 602 Q 431 612 421 612 L 226 612 Q 216 612 216 602 L 216 570 Q 216 560 226 560 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 226 560 L 421 560 Q 431 560 431 570 L 431 602 Q 431 612 421 612 L 226 612 Q 216 612 216 602 L 216 570 Q 216 560 226 560 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="226" y="579.5">Resources successfully allocated</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 236 584 L 401 584 L 411 594 L 411 609 L 236 609 L 236 584"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 236 584 L 401 584 L 411 594 L 411 609 L 236 609 L 236 584 L 236 584" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 401 584 L 401 594 L 411 594 L 401 584" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="241" y="602">return SLURM_SUCCESS;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 491 502 L 377 559" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 384.2072191549614 550.6900064950472 L 377 559 L 387.97232629693906 558.2202207790025" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="275" y="532">"rc" is SLURM_SUCCESS</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 506.3703703703704 502 L 611.3981481481482 559" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 600.4581924499581 557.8522328974744 L 611.3981481481482 559 L 604.4740251894962 550.4526892385109" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="565" y="533">"rc" is SLURM_ERROR</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 266 711 L 763 711 Q 766 711 766 714 L 766 713 Q 766 716 763 716 L 266 716 Q 263 716 263 713 L 263 714 Q 263 711 266 711 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#000000" stroke="none" d="M 259 704 L 756 704 Q 759 704 759 707 L 759 707 Q 759 710 756 710 L 259 710 Q 256 710 256 707 L 256 707 Q 256 704 259 704 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 145 767 L 497 767 Q 507 767 507 777 L 507 852 Q 507 862 497 862 L 145 862 Q 135 862 135 852 L 135 777 Q 135 767 145 767 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 138 760 L 490 760 Q 500 760 500 770 L 500 845 Q 500 855 490 855 L 138 855 Q 128 855 128 845 L 128 770 Q 128 760 138 760 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 138 760 L 490 760 Q 500 760 500 770 L 500 845 Q 500 855 490 855 L 138 855 Q 128 855 128 845 L 128 770 Q 128 760 138 760 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="199" y="779.5">QOS based preempt and Job Allocation</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 529 767 L 1025 767 Q 1035 767 1035 777 L 1035 1057 Q 1035 1067 1025 1067 L 529 1067 Q 519 1067 519 1057 L 519 777 Q 519 767 529 767 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 522 760 L 1018 760 Q 1028 760 1028 770 L 1028 1050 Q 1028 1060 1018 1060 L 522 1060 Q 512 1060 512 1050 L 512 770 Q 512 760 522 760 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 522 760 L 1018 760 Q 1028 760 1028 770 L 1028 1050 Q 1028 1060 1018 1060 L 522 1060 Q 512 1060 512 1050 L 512 770 Q 512 760 522 760 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="591" y="779.5">preemptee_candidate based only preemption &amp; Job Allocation</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 140 784 L 481 784 L 491 794 L 491 852 L 140 852 L 140 784"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 140 784 L 481 784 L 491 794 L 491 852 L 140 852 L 140 784 L 140 784" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 481 784 L 481 794 L 491 794 L 481 784" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="145" y="802">if(rc!=SLURM_SUCCESS &amp; preemptee_candidates &amp;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="145" y="817">        preempt_qos&amp;mode=PREEMPT_MODE_SUSPEND)</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="145" y="832">   rc = cr_job_test(param_NC ,qos_preemptor=true);</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 520 784 L 1011 784 L 1021 794 L 1021 1051 L 520 1051 L 520 784"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 520 784 L 1011 784 L 1021 794 L 1021 1051 L 520 1051 L 520 784 L 520 784" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 1011 784 L 1011 794 L 1021 794 L 1011 784" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="802">if(rc!=SLURM_SUCCESS &amp; preemptee_candidates) //preempt_qos = false</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="817">   remove preemptable jobs now; </text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="832">   rc = cr_job_test(bitmap);</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="847">//re-order preemption candidates to minimize number of preempted jobs and their</text><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="860">properties</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="875">   if(preempt_strict_order) {</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="890">        list_prepend(preemptee_candidates,(struct job_record*)</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="905">                                                    list_remove(job_iterator));</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="920">   }</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="935">   else {</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="950">        untill tmp_job_ptr-&gt;details-&gt;usable_nodes = 99999</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="965">            </text><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="978">tmp_job_ptr-&gt;details-&gt;usable_nodes=bit_overlap(bit_map,tmp_job_ptr-&gt;node_map);</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="993">        after tmp_job_ptr-&gt;details-&gt;usable_nodes = 99999</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="1008">             tmp_job_ptr -&gt;details-&gt;usable_nodes = 0;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="1023">        list_sort(preemptee_candidates,(ListCmpF)_sort_usable_nodes_desc)</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="1038">   }</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 608.23 653 L 512.73 703" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 519.7808242697076 694.556903582352 L 512.73 703 L 523.6858563851957 702.0155149229342" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="560" y="689">preempt_qos check</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 499.35643564356434 710 L 405.7227722772277 759" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 412.775214454349 750.5582549589341 L 405.7227722772277 759 L 416.6788171281818 758.0176145237829" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="304" y="736">preempt_qos is true</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 512.156862745098 710 L 575.328431372549 759" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 564.7182741959632 756.0974899331533 L 575.328431372549 759 L 569.8783018342596 749.4451013602516" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="619" y="741">preempt_qos is false</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 218 1015 L 427 1015 Q 430 1015 430 1018 L 430 1017 Q 430 1020 427 1020 L 218 1020 Q 215 1020 215 1017 L 215 1018 Q 215 1015 218 1015 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#000000" stroke="none" d="M 211 1008 L 420 1008 Q 423 1008 423 1011 L 423 1011 Q 423 1014 420 1014 L 211 1014 Q 208 1014 208 1011 L 208 1011 Q 208 1008 211 1008 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 314.2413793103448 856 L 314.98522167487687 1007" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 310.7256931628425 996.8581847357011 L 314.98522167487687 1007 L 319.1446265262869 996.816712157556" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="261" y="926">return rc</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 511 966.9230769230769 L 328.65 1007" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 337.67217513793577 1000.7071186424331 L 328.65 1007 L 339.479380302225 1008.9299021399491" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="404" y="1000">return rc</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#C0C0C0" stroke="none" d="M 209 1107 L 808 1107 Q 818 1107 818 1117 L 818 1201 Q 818 1211 808 1211 L 209 1211 Q 199 1211 199 1201 L 199 1117 Q 199 1107 209 1107 Z" opacity="0.2"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 202 1100 L 801 1100 Q 811 1100 811 1110 L 811 1194 Q 811 1204 801 1204 L 202 1204 Q 192 1204 192 1194 L 192 1110 Q 192 1100 202 1100 Z"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 202 1100 L 801 1100 Q 811 1100 811 1110 L 811 1194 Q 811 1204 801 1204 L 202 1204 Q 192 1204 192 1194 L 192 1110 Q 192 1100 202 1100 Z" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="429" y="1119.5">Create preemptee job list</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 228 1128 L 719 1128 L 729 1138 L 729 1203 L 228 1203 L 228 1128"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 228 1128 L 719 1128 L 729 1138 L 729 1203 L 228 1203 L 228 1128 L 228 1128" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 719 1128 L 719 1138 L 729 1138 L 719 1128" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="233" y="1146">1)if(rc=SLURM_SUCCESS&amp;preemptee_job_list&amp;preemptee_candidates)</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="233" y="1161">       Build list of preemptte jobs(preemptee_job_list) whose resources are actually</text><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="233" y="1174">used ;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="233" y="1189">2)return rc;</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 320.23943661971833 1014 L 431.5774647887324 1099" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 420.94533584157466 1096.1790366803148 L 431.5774647887324 1099 L 426.0541366045754 1089.487227230187" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="323" y="1066">return rc</text></g></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 500.47 1205 L 500.13 1239" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 496.02231437170735 1228.7957401650528 L 500.13 1239 L 504.44092896353243 1228.879926310971" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 215 586.9191489361702 L 88 588 L 96 1256 L 487 1252.1287128712872" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><path fill="none" stroke="#000000" d="M 476.87949957817244 1256.4386399254017 L 487 1252.1287128712872 L 476.7961468763407 1248.0200170403955" stroke-miterlimit="10"></path></g><g transform="translate(-78,-46) scale(1,1)"><g><path fill="none" stroke="none"></path><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="128" y="1248">resource is selected for the job</text></g></g></g></svg>